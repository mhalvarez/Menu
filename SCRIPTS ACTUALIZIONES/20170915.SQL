
-- OJO BUSCAR RMC10  Y SUBSTITUIR POR RMC DEL CLIENTE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!

ALTER TABLE TH_PARA
 ADD (PARA_SECC_ANTNH  VARCHAR2(15 BYTE));


COMMENT ON COLUMN TH_PARA.PARA_SECC_ANTNH IS 'Codigo de Seccion Anticipos en Newhotel';





ALTER TABLE TH_PARA
 ADD (PARA_MORA_GRUPONEGOCIO  VARCHAR2(25 BYTE)     DEFAULT 'CANARIAS');

ALTER TABLE TH_PARA
 ADD (PARA_MORA_GRUPOPRODUCTO  VARCHAR2(25 BYTE)    DEFAULT 'PRODUCTO');


COMMENT ON COLUMN TH_PARA.PARA_MORA_GRUPONEGOCIO IS 'Igic Grupo de Negocio';

COMMENT ON COLUMN TH_PARA.PARA_MORA_GRUPOPRODUCTO IS 'Igic Grupo de Producto';



ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_PROVEEDOR  VARCHAR2(25 BYTE));


ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_PRODUCTO  VARCHAR2(25 BYTE));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_PRODUCTO_DESCRIPCION  VARCHAR2(25 BYTE));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_CODALMACEN  VARCHAR2(25 BYTE));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_CANTIDAD  NUMBER);

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_UMEDIDA  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_COSTE  NUMBER);

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_GLOBALDIM1  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_GLOBALDIM2  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_SHORCUTDIM3  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_DOCEXTERNO  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_GRIVANEGOCIO  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_GRIVAPRODUCTO  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_GRCONTANEGOCIO  VARCHAR2(25));

ALTER TABLE TS_ASNT
 ADD (ASNT_MORA_GRCONTAPRODUCTO  VARCHAR2(25));


COMMENT ON COLUMN TS_ASNT.ASNT_MORA_COSTE IS 'Coste Unitario';



COMMENT ON COLUMN TS_ASNT.ASNT_MORA_PROVEEDOR IS 'Proveedor Externo';

COMMENT ON COLUMN TS_ASNT.ASNT_MORA_PRODUCTO IS 'Producto Externo ';

COMMENT ON COLUMN TS_ASNT.ASNT_MORA_PRODUCTO_DESCRIPCION IS 'Producto Descripcion';

COMMENT ON COLUMN TS_ASNT.ASNT_MORA_CODALMACEN IS 'Almacen Externo';

COMMENT ON COLUMN TS_ASNT.ASNT_MORA_CANTIDAD IS 'Cantidad';

COMMENT ON COLUMN TS_ASNT.ASNT_MORA_UMEDIDA IS 'Unidad de medida Externa';



CREATE TABLE TG_TRANS
(
  TRANS_CODI  NUMBER,
  TRANS_EMPGRUPO_COD  VARCHAR2(4BYTE),
  TRANS_EMP_COD  VARCHAR2(4BYTE),
  TRANS_EMP_NUM  NUMBER,
  
  TRANS_TABL  VARCHAR2(50 BYTE),
  TRANS_PKEY  VARCHAR2(50 BYTE),
  TRANS_TYPE  NUMBER,
  TRANS_STAT  NUMBER,
  TRANS_HOTE  NUMBER,
  TRANS_ERRO  VARCHAR2(4000 BYTE)
)
TABLESPACE USERS
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;

COMMENT ON COLUMN TG_TRANS.TRANS_PKEY IS '''Primary Key a tratar''';

COMMENT ON COLUMN TG_TRANS.TRANS_TYPE IS '''1=Insert,2=Update,3=Delete';

COMMENT ON COLUMN TG_TRANS.TRANS_STAT IS '''0=No Enviado,1=Si Enviado''';

COMMENT ON COLUMN TG_TRANS.TRANS_HOTE IS '''Hotel Origen''';

COMMENT ON COLUMN TG_TRANS.TRANS_ERRO IS '''Resultado del Envio''';


CREATE UNIQUE INDEX TG_TRANS_PK ON TG_TRANS
(TRANS_CODI)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
NOPARALLEL;


ALTER TABLE TG_TRANS ADD (
  CONSTRAINT TG_TRANS_PK
  PRIMARY KEY
  (TRANS_CODI)
  USING INDEX TG_TRANS_PK);

  
  
  CREATE SEQUENCE TG_TRANS_SEC
START WITH 1
INCREMENT BY 1
MINVALUE 0
NOCACHE 
NOCYCLE 
NOORDER ;




CREATE OR REPLACE TRIGGER TG_TRANS_TRG1
BEFORE INSERT
ON TG_TRANS
REFERENCING NEW AS NEW OLD AS OLD
FOR EACH ROW
DECLARE 
vcodigo NUMBER;

BEGIN
  

  IF(inserting) THEN
  
     select TG_TRANS_SEC.nextval into vcodigo from dual;

    :NEW.TRANS_CODI := vcodigo;
   
    
  END IF;
  
  

EXCEPTION
WHEN others THEN
  -- Consider logging the error and then re-raise
  RAISE;

END TG_TRANS_TRG1;

/



alter session set nls_language = 'AMERICAN';
alter session set nls_territory = 'AMERICA';
alter session set nls_date_format = 'DD-MON-YYYY';
  
UPDATE TH_PARA SET PARA_PAT_NUM = 'PAT0041';
UPDATE TH_PARA SET PARA_FECHA_BASE = '15-SEP-2017';
UPDATE TH_PARA SET PARA_FECHA_EXE  = '15-SEP-2017';

COMMIT;
