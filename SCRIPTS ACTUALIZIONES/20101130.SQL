


CREATE TABLE TN_PARA
(
  PARA_EMPGRUPO_COD    VARCHAR2(4 BYTE)         NOT NULL,
  PARA_EMP_COD         VARCHAR2(4 BYTE)         NOT NULL,
  PARA_EMP_NUM         NUMBER                   DEFAULT 0,
  PARA_CFATODIARI_COD  VARCHAR2(4 BYTE),
  PARA_FILE_ORIGEN     VARCHAR2(1024 BYTE),
  PARA_FILE_DESTINO    VARCHAR2(1024 BYTE),
  PARA_PRODUCTOR       VARCHAR2(20 BYTE),
  PARA_NOMBRE          VARCHAR2(100 BYTE),
  PARA_CTA_BRUTO       VARCHAR2(20 BYTE),
  PARA_CTA_INDEM       VARCHAR2(20 BYTE),
  PARA_CTA_SSEMPRE     VARCHAR2(20 BYTE),
  PARA_CTA_NETO        VARCHAR2(20 BYTE),
  PARA_CTA_IRPF        VARCHAR2(20 BYTE),
  PARA_CTA_SSTOTAL     VARCHAR2(20 BYTE),
  PARA_CTA_755PERSO    VARCHAR2(20 BYTE),
  PARA_CTA_EMBCUOTA    VARCHAR2(20 BYTE),
  PARA_CTA_ANTIPREST   VARCHAR2(20 BYTE),
  PARA_CTA_OTROS       VARCHAR2(20 BYTE)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;

COMMENT ON COLUMN TN_PARA.PARA_EMP_NUM IS 'Key Para Hoteles con mas de un Hotel en una sola empresa';

COMMENT ON COLUMN TN_PARA.PARA_CFATODIARI_COD IS 'Diario en Spyro';


CREATE UNIQUE INDEX TN_PARA_PK ON TN_PARA
(PARA_EMPGRUPO_COD, PARA_EMP_COD, PARA_EMP_NUM)
LOGGING
NOPARALLEL;


ALTER TABLE TN_PARA ADD (
  CONSTRAINT TN_PARA_PK
 PRIMARY KEY
 (PARA_EMPGRUPO_COD, PARA_EMP_COD, PARA_EMP_NUM));








CREATE TABLE TN_ASNT
(
  ASNT_TIPO_REGISTRO      VARCHAR2(5 BYTE)      NOT NULL,
  ASNT_EMPGRUPO_COD       VARCHAR2(4 BYTE)      NOT NULL,
  ASNT_EMP_COD            VARCHAR2(4 BYTE)      NOT NULL,
  ASNT_CFEJERC_COD        VARCHAR2(4 BYTE)      NOT NULL,
  ASNT_CFATODIARI_COD     VARCHAR2(4 BYTE)      NOT NULL,
  ASNT_CFATOCAB_REFER     NUMBER(8)             NOT NULL,
  ASNT_LINEA              NUMBER(4)             NOT NULL,
  ASNT_CFCTA_COD          VARCHAR2(15 BYTE)     NOT NULL,
  ASNT_CFCPTOS_COD        VARCHAR2(4 BYTE)      NOT NULL,
  ASNT_AMPCPTO            VARCHAR2(40 BYTE),
  ASNT_I_MONEMP           NUMBER(14,2),
  ASNT_CONCIL_SN          VARCHAR2(1 BYTE)      NOT NULL,
  ASNT_F_ATOCAB           DATE                  NOT NULL,
  ASNT_F_VALOR            DATE                  NOT NULL,
  ASNT_NOMBRE             VARCHAR2(100 BYTE),
  ASNT_DEBE               NUMBER,
  ASNT_HABER              NUMBER,
  ASNT_AJUSTAR            VARCHAR2(2 BYTE),
  ASNT_AJUSTE             NUMBER,
  ASNT_CIF                VARCHAR2(20 BYTE),
  ASNT_IMPRIMIR           VARCHAR2(2 BYTE)      DEFAULT 'SI',
  ASNT_AUXILIAR_STRING    VARCHAR2(1000 BYTE),
  ASNT_AUXILIAR_NUMERICO  NUMBER,
  ASNT_AUXILIAR_STRING2   VARCHAR2(1000 BYTE),
  ASNT_DPTO_CODI          VARCHAR2(20 BYTE),
  ASNT_AX_STATUS          NUMBER                DEFAULT 0,
  ASNT_ERR_MESSAGE        VARCHAR2(4000 BYTE),
  ASNT_EMP_NUM            NUMBER                DEFAULT 0,
  ASNT_PRODUC             VARCHAR2(10 BYTE),
  ASNT_BRUTO              NUMBER                DEFAULT 0,
  ASNT_INDEM              NUMBER                DEFAULT 0,
  ASNT_SSEMPE             NUMBER                DEFAULT 0,
  ASNT_NETO               NUMBER                DEFAULT 0,
  ASNT_IRPF               NUMBER                DEFAULT 0,
  ASNT_SSTOTAL            NUMBER                DEFAULT 0,
  ASNT_755PERSO           NUMBER                DEFAULT 0,
  ASNT_EMBCUOTA           NUMBER                DEFAULT 0,
  ASNT_ANTIPREST          NUMBER                DEFAULT 0,
  ASNT_OTROSDTOS          NUMBER                DEFAULT 0
);


COMMENT ON COLUMN TN_ASNT.ASNT_AUXILIAR_STRING IS 'Cualquier uso alfanumerico';

COMMENT ON COLUMN TN_ASNT.ASNT_AUXILIAR_NUMERICO IS 'Cualquier uso numerico';

COMMENT ON COLUMN TN_ASNT.ASNT_AX_STATUS IS 'Ax Estado de Envio Axapta 0=No enviado,1=Enviado Ok';

COMMENT ON COLUMN TN_ASNT.ASNT_ERR_MESSAGE IS 'Ax Descripcion del Error caso de producirse';

COMMENT ON COLUMN TN_ASNT.ASNT_EMP_NUM IS 'Key Para Hoteles con mas de un Hotel en una sola empresa';


CREATE UNIQUE INDEX TN_ASNT_PK ON TN_ASNT
(ASNT_TIPO_REGISTRO, ASNT_EMPGRUPO_COD, ASNT_EMP_COD, ASNT_CFATOCAB_REFER, ASNT_LINEA, 
ASNT_F_ATOCAB, ASNT_EMP_NUM)
LOGGING
NOPARALLEL;


ALTER TABLE TN_ASNT ADD (
  CONSTRAINT TN_ASNT_PK
 PRIMARY KEY
 (ASNT_TIPO_REGISTRO, ASNT_EMPGRUPO_COD, ASNT_EMP_COD, ASNT_CFATOCAB_REFER, ASNT_LINEA, ASNT_F_ATOCAB, ASNT_EMP_NUM));




ALTER TABLE TH_PARA 
ADD (PARA_CTA_REDONDEO_TOPE NUMBER DEFAULT 0 NOT NULL);


ALTER TABLE TN_ASNT 
ADD (ASNT_APU_ORDE NUMBER DEFAULT 0 NOT NULL);


ALTER TABLE TN_PARA
 ADD (PARA_CFATOTIP_COD  VARCHAR2(4)                DEFAULT 'NEWN');


COMMENT ON COLUMN TN_PARA.PARA_CFATOTIP_COD IS 'Tipo de Asiento';



ALTER TABLE TH_PARA
 ADD (PARA_PASO  VARCHAR2(50)                       DEFAULT 'PEPE');



COMMENT ON COLUMN TH_PARA.PARA_PASO IS 'Palabra de Paso';


----------------------------------
SET SERVEROUTPUT ON;

DECLARE
   V_DESCRIPCION   VARCHAR2 (200);

   CURSOR CUR_TREE
   IS
      SELECT PARA_EMPGRUPO_COD, PARA_EMP_COD, PARA_EMP_NUM
        FROM TH_PARA;
BEGIN
   FOR C IN CUR_TREE
   LOOP
      INSERT INTO TN_PARA
                  (PARA_EMPGRUPO_COD, PARA_EMP_COD, PARA_EMP_NUM
                  )
           VALUES (C.PARA_EMPGRUPO_COD, C.PARA_EMP_COD, C.PARA_EMP_NUM
                  );

      COMMIT;
   END LOOP;
EXCEPTION
   WHEN OTHERS
   THEN
      DBMS_OUTPUT.PUT_LINE (SQLERRM);
END;

----------------------







UPDATE TH_PARA SET PARA_PAT_NUM = 'PAT0023';
UPDATE TH_PARA SET PARA_FECHA_BASE = '30-NOV-2010';
UPDATE TH_PARA SET PARA_FECHA_EXE  = '30-NOV-2010';

COMMIT;